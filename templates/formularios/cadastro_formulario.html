<div class="container-fluid px-5">
  <div class="row justify-content-center">
    <div class="col-md-10 mt-4">
      <h3 class="mb-3">{{ 'Editar' if formulario else 'Novo' }} Formulário</h3>
      <div class="form-container">
      <form method="POST" id="formBuilderForm" action="{{ action_url }}" data-form-id="{{ formulario.id if formulario else '' }}">
        <div class="card shadow-sm mb-3">
          <div class="card-body">
            <div class="mb-3">
              <label for="nome" class="form-label">Nome</label>
              <input type="text" class="form-control" id="nome" name="nome" value="{{ formulario.nome if formulario else '' }}" required>
            </div>
            <div class="mb-3">
              <label for="descricao" class="form-label">Descrição</label>
              <textarea class="form-control no-quill" id="descricao" name="descricao">{{ formulario.descricao if formulario else '' }}</textarea>
            </div>
          </div>
        </div>

        <div class="card shadow-sm">
          <div class="card-body">
            <div id="previewContainer" class="mb-3"></div>
            <div id="fieldsContainer" class="mb-2"></div>
            <div class="form-text mb-3">Arraste os campos para reorganizá-los e use o ícone de ramificação para configurar fluxos condicionais.</div>
            <div class="dropdown mb-3">
              <button class="btn btn-outline-primary dropdown-toggle" type="button" id="addFieldBtn" data-bs-toggle="dropdown" aria-expanded="false">
                Adicionar Pergunta
              </button>
              <ul class="dropdown-menu" aria-labelledby="addFieldBtn" id="questionTypeMenu">
                <li><button class="dropdown-item" type="button" onclick="addField('text')">Texto</button></li>
                <li><button class="dropdown-item" type="button" onclick="addField('textarea')">Parágrafo</button></li>
                <li><button class="dropdown-item" type="button" onclick="addField('select')">Escolha</button></li>
                <li><button class="dropdown-item" type="button" onclick="addField('option')">Opção</button></li>
                <li><button class="dropdown-item" type="button" onclick="addField('rating')">Classificação</button></li>
                <li><button class="dropdown-item" type="button" onclick="addField('date')">Data</button></li>
                <li><button class="dropdown-item" type="button" onclick="addField('number')">Número</button></li>
                <li><button class="dropdown-item" type="button" onclick="addField('likert')">Likert</button></li>
                <li><button class="dropdown-item" type="button" onclick="addField('file')">Carregar Arquivo</button></li>
                <li><button class="dropdown-item" type="button" onclick="addField('nps')">Net Promoter Score®</button></li>
                <li><button class="dropdown-item" type="button" onclick="addField('section')">Seção</button></li>
                <li><button class="dropdown-item" type="button" onclick="addField('table')">Tabelas</button></li>
              </ul>
            </div>
            <input type="hidden" id="estrutura" name="estrutura" value="{{ formulario.estrutura|e if formulario else '' }}">
          </div>
        </div>

        <div class="mt-3">
          <button type="submit" class="btn btn-primary">Salvar</button>
          <a href="{{ url_for('formularios_bp.formularios') }}" class="btn btn-secondary">Cancelar</a>
        </div>
      </form>
      </div>
    </div>
  </div>
</div>
